---
// Video slider component
---

<section class="py-16 bg-white" style="background: linear-gradient(rgb(242, 242, 242) 0%, rgb(139, 168, 189) 100%);">
  <div class="max-w-6xl mx-auto px-4 md:px-8">
    
    <!-- Header -->
    <div class="text-center mb-2">
      <h2 class="text-3xl md:text-4xl font-heading text-aopa-dkblue mb-8 uppercase">Aviation Video</h2>
      <p class="text-lg text-gray-700 uppercase tracking-wide">Featured Playlists</p>
    </div>

    <!-- Playlist Tabs -->
    <div class="flex justify-center mb-12">
      <div class="relative flex bg-gray-100 rounded-full p-2">
        <!-- Sliding background pill -->
        <div id="tabPill" class="absolute top-2 bottom-2 bg-aopa-dkblue rounded-full transition-all duration-300 ease-out"></div>
        
        <button 
          class="relative z-10 px-6 py-4 rounded-full text-sm font-ui text-aopa-dkblue transition-colors duration-200 playlist-tab border-0 outline-none" 
          data-playlist="pilot-turbine"
        >
          AirVenture 2025
        </button>
        <button 
          class="relative z-10 px-6 py-4 rounded-full text-sm font-ui text-white transition-colors duration-200 playlist-tab active border-0 outline-none" 
          data-playlist="pilot-magazine"
        >
          Aopa Sweepstakes
        </button>
        <button 
          class="relative z-10 px-6 py-4 rounded-full text-sm font-ui text-aopa-dkblue transition-colors duration-200 playlist-tab border-0 outline-none" 
          data-playlist="flight-training"
        >
          AOPA Presents
        </button>
      </div>
    </div>
  </div>

  <!-- Full Width Video Slider Container -->
  <div class="relative overflow-hidden w-full">
    <div class="video-slider flex transition-transform duration-500 ease-out" id="videoSlider">
      
      <!-- AirVenture 2025 Video -->
      <div class="flex-shrink-0 px-2" style="width: 75vw;" data-video="pilot-turbine">
        <div class="relative rounded-3xl aspect-video overflow-hidden">
          <iframe 
            width="100%" 
            height="100%" 
            src="https://www.youtube.com/embed/videoseries?list=PLQCVVyDKYo3KbjQgplasyGrglVjEpmZs7&autoplay=0&mute=0&controls=1&showinfo=1&rel=0&modestbranding=1"
            title="AirVenture 2025 Playlist"
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            allowfullscreen
            class="rounded-3xl">
          </iframe>
        </div>
      </div>

      <!-- AOPA Sweepstakes Video (Center) -->
      <div class="flex-shrink-0 px-2" style="width: 75vw;" data-video="pilot-magazine">
        <div class="relative rounded-3xl aspect-video overflow-hidden">
          <iframe 
            width="100%" 
            height="100%" 
            src="https://www.youtube.com/embed/videoseries?list=PLQCVVyDKYo3IgY2di0q-y43vKa3Toi7pm&autoplay=0&mute=0&controls=1&showinfo=1&rel=0&modestbranding=1"
            title="AOPA Sweepstakes Playlist"
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            allowfullscreen
            class="rounded-3xl">
          </iframe>
        </div>
      </div>

      <!-- AOPA Presents Video -->
      <div class="flex-shrink-0 px-2" style="width: 75vw;" data-video="flight-training">
        <div class="relative rounded-3xl aspect-video overflow-hidden">
          <iframe 
            width="100%" 
            height="100%" 
            src="https://www.youtube.com/embed/videoseries?list=PLQCVVyDKYo3JACIIpzS9iAYK5KB7yN56x&autoplay=0&mute=0&controls=1&showinfo=1&rel=0&modestbranding=1"
            title="AOPA Presents Playlist"
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            allowfullscreen
            class="rounded-3xl">
          </iframe>
        </div>
      </div>

    </div>
  </div>

  <!-- Navigation Dots -->
  <div class="max-w-6xl mx-auto px-4 md:px-8">
    <div class="flex justify-center mt-8 space-x-2">
      <button class="w-2 h-2 rounded-full bg-gray-300 transition-all duration-200 nav-dot" data-slide="0"></button>
      <button class="w-2 h-2 rounded-full bg-aopa-dkblue transition-all duration-200 nav-dot active" data-slide="1"></button>
      <button class="w-2 h-2 rounded-full bg-gray-300 transition-all duration-200 nav-dot" data-slide="2"></button>
    </div>
  </div>
</section>

<script>
  class VideoSlider {
    constructor() {
      this.slider = document.getElementById('videoSlider');
      this.currentSlide = 1; // Start at center slide
      this.currentPlaylist = 'pilot-magazine'; // Start with Pilot Magazine
      
      this.init();
    }

    init() {
      // Set up the slider dimensions
      this.setupSlider();
      
      // Set initial position to center slide (Pilot Magazine video)
      this.currentSlide = 1; // Center slide
      this.centerSlider();
      
      // Initialize tab pill position
      this.initializeTabPill();
      
      // Add event listeners
      this.addEventListeners();
    }

    centerSlider() {
      const containerWidth = this.slider.parentElement.offsetWidth;
      const slideWidth = containerWidth * 0.75; // Each slide is 75% of container width
      const centerOffset = (containerWidth - slideWidth) / 2; // Center the slide
      const translateX = -this.currentSlide * slideWidth + centerOffset;
      this.slider.style.transform = `translateX(${translateX}px)`;
    }

    setupSlider() {
      // Set the slider to 300% width to accommodate 3 videos (75vw each)
      this.slider.style.width = '300%';
    }

    addEventListeners() {
      // Navigation dots
      document.querySelectorAll('.nav-dot').forEach((dot, index) => {
        dot.addEventListener('click', () => this.goToSlide(index));
      });

      // Playlist tabs
      const tabs = document.querySelectorAll('.playlist-tab');
      console.log('Found tabs:', tabs.length);
      tabs.forEach(tab => {
        tab.addEventListener('click', (e) => {
          e.preventDefault();
          console.log('Tab clicked:', e.target.dataset.playlist);
          this.switchPlaylist(e.target);
        });
      });
    }


    goToSlide(slideIndex) {
      this.currentSlide = slideIndex;
      this.updateSliderPosition();
      this.updateNavigationDots();
    }

    updateSliderPosition() {
      const containerWidth = this.slider.parentElement.offsetWidth;
      const slideWidth = containerWidth * 0.75; // Each slide is 75% of container width
      const centerOffset = (containerWidth - slideWidth) / 2; // Center the slide
      const translateX = -this.currentSlide * slideWidth + centerOffset;
      this.slider.style.transform = `translateX(${translateX}px)`;
    }


    updateNavigationDots() {
      document.querySelectorAll('.nav-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === this.currentSlide);
        dot.classList.toggle('bg-aopa-dkblue', index === this.currentSlide);
        dot.classList.toggle('bg-gray-300', index !== this.currentSlide);
      });
    }

    switchPlaylist(activeTab) {
      console.log('Switching to video:', activeTab.dataset.playlist);
      
      // Update tab states
      document.querySelectorAll('.playlist-tab').forEach(tab => {
        tab.classList.remove('active', 'text-white');
        tab.classList.add('text-aopa-dkblue');
      });
      
      activeTab.classList.add('active', 'text-white');
      activeTab.classList.remove('text-aopa-dkblue');
      
      // Move the sliding pill
      this.moveTabPill(activeTab);
      
      // Find which video corresponds to this tab and slide to it
      const videos = this.slider.querySelectorAll('[data-video]');
      let targetSlide = 1; // Default to center
      
      videos.forEach((video, index) => {
        if (video.dataset.video === activeTab.dataset.playlist) {
          targetSlide = index;
        }
      });
      
      console.log('Sliding to video at index:', targetSlide);
      this.goToSlide(targetSlide);
    }

    initializeTabPill() {
      // Find the active tab (middle one by default)
      const activeTab = document.querySelector('.playlist-tab.active');
      if (activeTab) {
        this.moveTabPill(activeTab);
      }
    }

    moveTabPill(activeTab) {
      const pill = document.getElementById('tabPill');
      const tabContainer = activeTab.parentElement;
      const tabRect = activeTab.getBoundingClientRect();
      const containerRect = tabContainer.getBoundingClientRect();
      
      // Calculate the position relative to the container
      const left = tabRect.left - containerRect.left;
      const width = tabRect.width;
      
      // Move the pill to the active tab position
      pill.style.left = `${left}px`;
      pill.style.width = `${width}px`;
    }

  }

  // Initialize slider when DOM is loaded
  document.addEventListener('DOMContentLoaded', () => {
    new VideoSlider();
  });
</script>

<style>
  
  
  .nav-dot.active {
    background-color: #0a2d3a;
  }
  
  .playlist-tab {
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
  }
  
  .playlist-tab:focus {
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
  }
  
  .playlist-tab:active {
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
  }
  
  .drag-overlay {
    background: transparent;
    cursor: grab;
  }
  
  .drag-overlay:active {
    cursor: grabbing;
  }
  
  .drag-overlay:hover {
    pointer-events: auto;
  }
</style>
